# å¤©è¡Œæ•°æ®API Home Assistant é›†æˆ

è¿™æ˜¯ä¸€ä¸ªä¸º Home Assistant å¼€å‘çš„å®šåˆ¶é›†æˆï¼Œç”¨äºä»[å¤©è¡Œæ•°æ®](https://www.tianapi.com/)è·å–å„ç±»æ–‡åŒ–èµ„è®¯å†…å®¹ï¼ŒåŒ…æ‹¬è°œè¯­ç¬‘è¯ã€æ—©å®‰æ™šå®‰ã€å¤è¯—å®‹è¯å’Œæ¯æ—¥ä¸€è¨€ç­‰ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ­ **è°œè¯­ç¬‘è¯** - æ¯æ—¥è°œè¯­å’Œç¬‘è¯
- ğŸŒ… **æ—©å®‰æ™šå®‰** - æ—©å®‰å¿ƒè¯­å’Œæ™šå®‰å¿ƒè¯­
- ğŸ“œ **å¤è¯—å®‹è¯** - å”è¯—ã€å®‹è¯ã€å…ƒæ›²é‰´èµ
- ğŸ’¬ **æ¯æ—¥ä¸€è¨€** - å†å²çŸ¥è¯†ã€å¤ç±åå¥ã€ç»å…¸å¯¹è”å’Œè‹±æ–‡æ ¼è¨€

## å®‰è£…å‰å‡†å¤‡

### 1. è·å– API å¯†é’¥

åœ¨ä½¿ç”¨æœ¬é›†æˆå‰ï¼Œæ‚¨éœ€è¦å…ˆç”³è¯·å¤©è¡Œæ•°æ®çš„ API å¯†é’¥ï¼š

1. è®¿é—® [å¤©è¡Œæ•°æ®å®˜ç½‘](https://www.tianapi.com/)
2. æ³¨å†Œè´¦å·å¹¶ç™»å½•
3. è¿›å…¥æ§åˆ¶å°ï¼Œç”³è¯· API å¯†é’¥
4. ç¡®ä¿æ‚¨çš„è´¦æˆ·æœ‰è¶³å¤Ÿçš„è°ƒç”¨æ¬¡æ•°ï¼ˆå…è´¹ç‰ˆæœ¬é€šå¸¸æœ‰æ¯æ—¥é™åˆ¶ï¼‰

### 2. å¯ç”¨è‡ªå®šä¹‰é›†æˆ

Home Assistant éœ€è¦å¯ç”¨è‡ªå®šä¹‰é›†æˆåŠŸèƒ½ï¼š

1. ç¡®ä¿æ‚¨çš„ Home Assistant å®ä¾‹å¯ä»¥è®¿é—®äº’è”ç½‘
2. ç¡®è®¤å·²å¯ç”¨é«˜çº§æ¨¡å¼ï¼ˆåœ¨ç”¨æˆ·é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼‰

## å®‰è£…æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ HACS å®‰è£…ï¼ˆæ¨èï¼‰

1. ç¡®ä¿å·²å®‰è£… [HACS](https://hacs.xyz/)
2. åœ¨ HACS ä¸­æœç´¢ "å¤©è¡Œæ•°æ®API"
3. ç‚¹å‡»å®‰è£…
4. é‡å¯ Home Assistant

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å®‰è£…

1. ä¸‹è½½æœ¬é›†æˆæ–‡ä»¶
2. å°† `custom_components/tianxing_api` æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ‚¨çš„ Home Assistant é…ç½®ç›®å½•ä¸­çš„ `custom_components` æ–‡ä»¶å¤¹å†…
3. é‡å¯ Home Assistant

## é…ç½®æ­¥éª¤

### 1. æ·»åŠ é›†æˆ

1. è¿›å…¥ Home Assistant çš„ **è®¾ç½®** â†’ **è®¾å¤‡ä¸æœåŠ¡** â†’ **é›†æˆ**
2. ç‚¹å‡»å³ä¸‹è§’çš„ **æ·»åŠ é›†æˆ** æŒ‰é’®
3. æœç´¢ "å¤©è¡Œæ•°æ®API"
4. ç‚¹å‡»è¿›å…¥é…ç½®ç•Œé¢

### 2. è¾“å…¥ API å¯†é’¥

1. åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­è¾“å…¥æ‚¨ä»å¤©è¡Œæ•°æ®è·å–çš„ API å¯†é’¥
2. API å¯†é’¥åº”ä¸º 32 ä½å­—ç¬¦ä¸²
3. ç‚¹å‡» **æäº¤**

### 3. å®Œæˆå®‰è£…

é›†æˆä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹å®ä½“ï¼š

- `sensor.tianxing_mi_yu_xiao_hua` - è°œè¯­ç¬‘è¯
- `sensor.tianxing_zao_an_wan_an` - æ—©å®‰æ™šå®‰  
- `sensor.tianxing_gu_shi_song_ci` - å¤è¯—å®‹è¯
- `sensor.tianxing_mei_ri_yi_yan` - æ¯æ—¥ä¸€è¨€

æ‰€æœ‰å®ä½“éƒ½ä¼šå½’å±äºåä¸º **"å¤©è¡Œä¿¡æ¯æŸ¥è¯¢"** çš„è®¾å¤‡ã€‚

## å®ä½“å±æ€§è¯´æ˜

### è°œè¯­ç¬‘è¯å®ä½“
- **çŠ¶æ€**: å½“å‰è°œè¯­å†…å®¹
- **å±æ€§**:
  - `riddle`: è°œè¯­è¯¦ç»†ä¿¡æ¯ï¼ˆå†…å®¹ã€ç­”æ¡ˆã€ç±»å‹ç­‰ï¼‰
  - `joke`: ç¬‘è¯è¯¦ç»†ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€å†…å®¹ï¼‰
  - `update_time`: æœ€åæ›´æ–°æ—¶é—´

### æ—©å®‰æ™šå®‰å®ä½“
- **çŠ¶æ€**: æ—©å®‰å†…å®¹æ‘˜è¦
- **å±æ€§**:
  - `morning`: å®Œæ•´çš„æ—©å®‰å¿ƒè¯­
  - `evening`: å®Œæ•´çš„æ™šå®‰å¿ƒè¯­
  - `update_time`: æœ€åæ›´æ–°æ—¶é—´

### å¤è¯—å®‹è¯å®ä½“
- **çŠ¶æ€**: å”è¯—å†…å®¹æ‘˜è¦
- **å±æ€§**:
  - `tangshi`: å”è¯—è¯¦ç»†ä¿¡æ¯ï¼ˆå†…å®¹ã€ä½œè€…ã€æ³¨é‡Šç­‰ï¼‰
  - `songci`: å®‹è¯è¯¦ç»†ä¿¡æ¯
  - `yuanqu`: å…ƒæ›²è¯¦ç»†ä¿¡æ¯
  - `update_time`: æœ€åæ›´æ–°æ—¶é—´

### æ¯æ—¥ä¸€è¨€å®ä½“
- **çŠ¶æ€**: å†å²çŸ¥è¯†æ‘˜è¦
- **å±æ€§**:
  - `history`: ç®€è¯´å†å²å†…å®¹
  - `sentence`: å¤ç±åå¥
  - `couplet`: ç»å…¸å¯¹è”
  - `maxim`: è‹±æ–‡æ ¼è¨€ï¼ˆå«ä¸­æ–‡ç¿»è¯‘ï¼‰
  - `update_time`: æœ€åæ›´æ–°æ—¶é—´

## è‡ªåŠ¨åŒ–ç¤ºä¾‹

### æ¯æ—¥æ—©å®‰æ’­æŠ¥
```yaml
automation:
  - alias: "Morning Greeting"
    trigger:
      - platform: time
        at: "07:00:00"
    action:
      - service: tts.speak
        data:
          message: "{{ state_attr('sensor.tianxing_zao_an_wan_an', 'morning') }}"
```

### æ¡Œé¢é€šçŸ¥æ˜¾ç¤ºæ¯æ—¥ä¸€è¨€
```yaml
automation:
  - alias: "Daily Wisdom Notification"
    trigger:
      - platform: time
        at: "09:00:00"
    action:
      - service: notify.persistent_notification
        data:
          message: >
            ä»Šæ—¥æ™ºæ…§ï¼š
            å†å²ï¼š{{ state_attr('sensor.tianxing_mei_ri_yi_yan', 'history')['content'] }}
            åå¥ï¼š{{ state_attr('sensor.tianxing_mei_ri_yi_yan', 'sentence')['content'] }}
          title: "æ¯æ—¥ä¸€è¨€"
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **é›†æˆæ— æ³•åŠ è½½**
   - æ£€æŸ¥ API å¯†é’¥æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆ32ä½å­—ç¬¦ä¸²ï¼‰
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
   - æŸ¥çœ‹ Home Assistant æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

2. **æ•°æ®ä¸æ›´æ–°**
   - ç¡®è®¤ API å¯†é’¥æœ‰æ•ˆä¸”æœªè¿‡æœŸ
   - æ£€æŸ¥å¤©è¡Œæ•°æ®è´¦æˆ·çš„è°ƒç”¨æ¬¡æ•°é™åˆ¶
   - ç­‰å¾…ä¸‹ä¸€ä¸ªè‡ªåŠ¨æ›´æ–°å‘¨æœŸï¼ˆ24å°æ—¶ï¼‰

3. **å®ä½“ä¸å¯ç”¨**
   - é‡å¯ Home Assistant
   - æ£€æŸ¥è‡ªå®šä¹‰é›†æˆæ–‡ä»¶å¤¹æƒé™
   - ç¡®è®¤æ‰€æœ‰ä¾èµ–æ–‡ä»¶å®Œæ•´

### æŸ¥çœ‹æ—¥å¿—

å¦‚éœ€è°ƒè¯•ï¼Œè¯·åœ¨ `configuration.yaml` ä¸­æ·»åŠ ï¼š

```yaml
logger:
  default: info
  logs:
    custom_components.tianxing_api: debug
```

## API è°ƒç”¨è¯´æ˜

æœ¬é›†æˆä½¿ç”¨ä»¥ä¸‹å¤©è¡Œæ•°æ® API æ¥å£ï¼š

- `caizimi/index` - è°œè¯­
- `joke/index` - ç¬‘è¯
- `zaoan/index` - æ—©å®‰
- `wanan/index` - æ™šå®‰
- `poetry/index` - å”è¯—
- `zmsc/index` - å®‹è¯
- `yuanqu/index` - å…ƒæ›²
- `pitlishi/index` - å†å²
- `gjmj/index` - åå¥
- `duilian/index` - å¯¹è”
- `enmaxim/index` - è‹±æ–‡æ ¼è¨€

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬ README æ–‡æ¡£
2. æ£€æŸ¥ Home Assistant æ—¥å¿—
3. è®¿é—® [å¤©è¡Œæ•°æ®å®˜æ–¹æ–‡æ¡£](https://www.tianapi.com/)
4. åœ¨é¡¹ç›® Issues é¡µé¢æäº¤é—®é¢˜

## ç‰ˆæœ¬å†å²

- v1.0.0 - åˆå§‹ç‰ˆæœ¬ï¼Œé›†æˆå››ä¸ªä¸»è¦åŠŸèƒ½æ¨¡å—

## å…è´£å£°æ˜

æœ¬é›†æˆä¸ºç¬¬ä¸‰æ–¹å¼€å‘ï¼Œä¸å¤©è¡Œæ•°æ®å®˜æ–¹æ— å…³ã€‚ä½¿ç”¨æœ¬é›†æˆéœ€è¦éµå®ˆå¤©è¡Œæ•°æ®çš„ API ä½¿ç”¨æ¡æ¬¾å’Œè°ƒç”¨é™åˆ¶ã€‚
